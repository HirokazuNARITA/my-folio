# TDD リファレンス（t-wada 式）

## レッド・グリーン・リファクタ

| フェーズ | やること |
|----------|----------|
| **RED** | 失敗するテストを書く。期待する振る舞いをテストで表現する |
| **GREEN** | テストが通る最小限の実装を行う。まず動かす |
| **REFACTOR** | 重複を削除し、設計を改善する。テストが通ったまま変更 |

## テストを書く順序

1. 最も単純な成功ケース
2. 境界値・エッジケース
3. エラーケース

## 複雑さの判断基準

TDD を適用する目安:

- 条件分岐が複数ある
- 外部サービス・DB とのやり取りがある
- ビジネスルールが入り組んでいる
- リグレッションを恐れる変更

## TDD の対象（バリデーションに限定されない）

| 対象 | 例 | テスト方法 |
|------|-----|------------|
| バリデーションスキーマ | Zod スキーマ | 直接 safeParse で検証 |
| Server Actions | createWork, updateWork | Prisma をモックしてテスト |
| API ハンドラ | Route Handler | リクエスト/レスポンスをモック |
| ビジネスロジック | 条件分岐、計算 | ユニットテスト |
| 外部サービス連携 | DB 操作、外部 API | モック or 統合テスト |

## ツール（Next.js / Folio の場合）

- ユニット: Vitest, Jest
- E2E: Playwright
- 描画確認: ブラウザ MCP (cursor-ide-browser)、`verify:pages`
